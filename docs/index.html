<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
  <meta charset="utf-8" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#ffcebf" />
  <meta name="msapplication-navbutton-color" content="#ffcebf" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="build-date" content="2026-01-03T23:11:34.365Z" />
  <title>Recept</title>
  <meta name="description" content="En enkel receptsamling.">
  <link rel="icon" type="image/png" href="data:image/png;base64,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" />
  <script src="https://cdn.jsdelivr.net/npm/minisearch@7.2.0/dist/umd/index.min.js"></script>

  <style>
    * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background-color: #f5f5f5;
    color: #111;
    line-height: 1.6;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 1rem;
}

header {
    padding-top: 1rem;
    margin-bottom: 2rem;
}

h1 {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 1.5rem;
    color: #111;
}

.search-container {
    position: relative;
    margin-bottom: 2rem;
}

.search-icon {
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: #666;
    width: 16px;
    height: 16px;
}

input[type="text"] {
    width: 100%;
    padding: 0.75rem 0.75rem 0.75rem 2.5rem;
    font-size: 1rem;
    border: 1px solid #ddd;
    border-radius: 0.5rem;
    background: white;
    color: #111;
}

input[type="text"]:focus {
    outline: none;
    border-color: #111;
}

input[type="text"]::placeholder {
    color: #888;
}

.recipe-card {
    background: white;
    border-radius: 0.75rem;
    padding: 1rem;
    margin-bottom: 0.75rem;
    cursor: pointer;
    border: 1px solid #e5e5e5;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    transition: background-color 0.2s;
}

.recipe-card:hover {
    background-color: #fafafa;
}

.recipe-card h2 {
    font-size: 1.125rem;
    font-weight: 600;
    color: #111;
    margin-bottom: 0.25rem;
}

.recipe-meta {
    font-size: 0.875rem;
    color: #666;
}

.detail-view {
    display: none;
}

.detail-view.active {
    display: block;
}

.list-view {
    display: block;
}

.list-view.hidden {
    display: none;
}

.back-button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    margin-bottom: 1rem;
    background: transparent;
    border: none;
    border-radius: 0.5rem;
    cursor: pointer;
    font-size: 1rem;
    color: #111;
    transition: background-color 0.2s;
}

.back-button:hover {
    background-color: #f0f0f0;
}

.recipe-detail-card {
    background: white;
    border-radius: 0.75rem;
    padding: 1.5rem;
    border: 1px solid #e5e5e5;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.recipe-detail-card h1 {
    font-size: 1.75rem;
    margin-bottom: 1.5rem;
    line-height: 2.5rem;
}

.section-title {
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: #111;
}

.ingredients-section {
    margin-bottom: 2rem;
}

.ingredients-section .ingredient-group {
    margin-bottom: 1rem; /* space between groups */
}

.ingredient {
    display: flex;
    gap: 0.5rem;
    color: #111;
}

.ingredient-amount {
    min-width: 60px;
    color: #666;
}

.instructions-section ol {
    list-style: none;
    counter-reset: step-counter;
}

.instruction {
    display: flex;
    gap: 0.75rem;
    counter-increment: step-counter;
}

.step-number {
    flex-shrink: 0;
    width: 1.5rem;
    height: 1.5rem;
    background: #111;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.875rem;
    font-weight: 500;
}

.step-number::before {
    content: counter(step-counter);
}

.instruction-text {
    padding-top: 0.125rem;
}

/* Cross-highlight styles */
.ingredient-group,
.instruction {
    cursor: pointer;
    padding: 0.25rem 0.5rem;
}
.ingredient-group.highlighted {
    background: #fffbe6; /* subtle yellow */
    border-radius: 0.5rem;
}
.instruction.highlighted {
    background: #eef6ff; /* subtle blue */
    border-radius: 0.5rem;
}
.instruction.highlighted .step-number {
    background: #0b5ed7; /* stronger blue for number */
}

.no-results {
    text-align: center;
    color: #666;
    padding: 2rem 0;
}

.arrow-icon {
    width: 16px;
    height: 16px;
}
  </style>
</head>
<body>
  <div class="container">
    <!-- List View -->
    <div id="list-view" class="list-view">
      <header>
        <h1>Recipes</h1>
        <div class="search-container">
          <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
          <input type="text" id="search" placeholder="Sök recept...">
        </div>
      </header>
      <div id="recipe-list"></div>
      <div id="no-results" class="no-results" style="display: none;">
        No recipes found
      </div>
    </div>
    <!-- Detail View -->
    <div id="detail-view" class="detail-view">
      <button class="back-button" id="back-button">
        <svg class="arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        Back
      </button>
      <div class="recipe-detail-card" id="recipe-detail"></div>
  </div>
  <script>
    // Recipe data
    const recipes = [{
  "id_name": "chapati",
  "id": 10,
  "title": "Chapati",
  "serves": 2,
  "ingredients": [
    { "groupId": 1, "amount": 2.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "vetemjöl (5 dl motsvarar ca 320 g)" },
    { "groupId": 1, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "salt" },
    { "groupId": 1, "amount": 2, "unit": "teaspoons", "unitSymbol": "tsk", "ingredientName": "olja" },
    { "groupId": 1, "amount": 1, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "ljummet vatten (ca 2 dl, efter behov)" },
    { "groupId": 1, "amount": 1, "unit": "pinch", "unitSymbol": "pch", "ingredientName": "socker" },
    { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "olja till stekning" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Blanda alla ingredienser till en smidig deg." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Dela degen i 5 delar, färre om du vill ha större bröd." },
    { "groupId": 2, "stepNumber": 3, "instruction": "Kavla ut till tunna runda bröd på mjölad bänk." },
    { "groupId": 2, "stepNumber": 4, "instruction": "Stek bröden 1–2 minuter per sida i en het, lätt oljad stekpanna. Bröden ska få fina bruna fläckar på båda sidor." }
  ],
  "notes": "Ger ca 5 bröd. Stek snabbt på hög värme för bästa resultat. Servera gärna nygräddade till indiska rätter. "
}
,
{
  "id": 11,
  "title": "Stekta thaifiskbollar",
  "serves": 4,
  "ingredients": [
    { "groupId": 1, "amount": 500, "unit": "grams", "unitSymbol": "g", "ingredientName": "torskfilé utan skinn" },
    { "groupId": 1, "amount": 1, "unit": "eggwhite", "unitSymbol": "", "ingredientName": "äggvita" },
    { "groupId": 1, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "finriven ingefära" },
    { "groupId": 1, "amount": 2, "unit": "cloves", "unitSymbol": "", "ingredientName": "finrivna vitlöksklyftor" },
    { "groupId": 1, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "salt" },
    { "groupId": 1, "amount": 2, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "panko" },
    { "groupId": 1, "amount": 3, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "neutral olja till stekning" },

    { "groupId": 2, "amount": 2, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "sweet chilisås" },
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "asiatisk fisksås" },
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "finriven ingefära" },
    { "groupId": 2, "amount": 1, "unit": "clove", "unitSymbol": "", "ingredientName": "riven vitlöksklyfta" },
    { "groupId": 2, "amount": 1, "unit": "piece", "unitSymbol": "", "ingredientName": "finrivet skal och pressad juice av 1 lime" },

    { "groupId": 3, "amount": 4, "unit": "servings", "unitSymbol": "", "ingredientName": "jasminris" },
    { "groupId": 3, "amount": 1, "unit": "deciliter", "unitSymbol": "dl", "ingredientName": "majonnäs" },
    { "groupId": 3, "amount": 2, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "hackade jordnötter" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Skär fisken i mindre bitar. Lägg fisken i en matberedare tillsammans med äggvita, ingefära, vitlök och salt. Mixa hastigt ihop till en färs." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Häll upp panko på en tallrik. Rulla ca 25 bollar av färsen och rulla dem sedan i panko." },
    { "groupId": 2, "stepNumber": 3, "instruction": "Blanda alla ingredienser till såsen." },
    { "groupId": 1, "stepNumber": 4, "instruction": "Värm oljan i en stekpanna och stek bollarna på medelvärme 7–8 minuter tills de får fin färg." },
    { "groupId": 3, "stepNumber": 5, "instruction": "Servera de nystekta fiskbollarna tillsammans med ris, och majonnäs, hackade jordnötter och såsen." }
  ]
}
,
{
  "id": 12,
  "title": "Sticky chicken med ris",
  "serves": 4,
  "ingredients": [
    { "groupId": 1, "amount": 3, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "ris" },
    { "groupId": 1, "amount": 1, "unit": "piece", "unitSymbol": "", "ingredientName": "färdiggrillad kyckling" },
    
    { "groupId": 4, "amount": 1, "unit": "piece", "unitSymbol": "", "ingredientName": "kålrabbi" },
    { "groupId": 4, "amount": 1, "unit": "piece", "unitSymbol": "", "ingredientName": "gurka" },
    { "groupId": 4, "amount": 2, "unit": "pinches", "unitSymbol": "krm", "ingredientName": "salt" },
    { "groupId": 4, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "socker" },
    { "groupId": 4, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "vinäger" },

    { "groupId": 2, "amount": 1.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "sweet chilisås" },
    { "groupId": 2, "amount": 0.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "ketchup" },
    { "groupId": 2, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "sesamolja" },
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "strösocker" },
    { "groupId": 2, "amount": 1, "unit": "clove", "unitSymbol": "", "ingredientName": "riven vitlöksklyfta" },
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "vinäger" },
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "kinesisk soja" },
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "finriven ingefära" },
    { "groupId": 2, "amount": 0.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "vatten" },

    { "groupId": 3, "amount": 2, "unit": "pieces", "unitSymbol": "", "ingredientName": "salladslökar" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "sesamfrön" },
    { "groupId": 3, "amount": null, "unit": "to taste", "unitSymbol": "", "ingredientName": "koriander" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Koka riset enligt anvisning på förpackningen." },
    { "groupId": 4, "stepNumber": 2, "instruction": "Skala kålrabbi. Strimla gurka och kålrabbi." },
    { "groupId": 4, "stepNumber": 3, "instruction": "Rör ihop salt, socker och vinäger. Blanda med gurkan och kålrabbin." },
    { "groupId": 3, "stepNumber": 4, "instruction": "Rosta sesamfrön i stekpanna och hacka salladslök tunt och ställ åt sidan." },
    { "groupId": 1, "stepNumber": 5, "instruction": "Plocka köttet från kycklingen och skär i bitar." },
    { "groupId": 2, "stepNumber": 6, "instruction": "Lägg alla ingredienser till såsen i en stekpanna. Låt koka ihop några minuter. Tillsätt kycklingen och låt koka 1 minut. Späd eventuellt med mer vatten." },
    { "groupId": 3, "stepNumber": 7, "instruction": "Servera med ris och de strimlade grönsakerna, toppa med salladslök, sesamfrön och gärna koriander." }
  ],
  "notes": "Kålrabbi kan bytas mot rättika eller vitkål."
}
,
{
  "id": 13,
  "title": "Pasta med krämig ost- och skinksås",
  "serves": 4,
  "ingredients": [
    { "groupId": 1,"amount": 4,"unit": "portions","unitSymbol": "port","ingredientName": "pasta (gärna gemelli)" },

    { "groupId": 2,"amount": 1, "unit": "deciliter", "unitSymbol": "dl", "ingredientName": "fryst hackad lök eller 1 hackad gul lök"},
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "smör eller olja" },

    { "groupId": 3, "amount": 2.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "matlagningsgrädde" },
    { "groupId": 3, "amount": 1.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "mjölk" },
    { "groupId": 3, "amount": 2, "unit": "teaspoons", "unitSymbol": "tsk", "ingredientName": "majsstärkelse" },
    { "groupId": 3, "amount": 2, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "kycklingfond" },

    { "groupId": 4, "amount": 2, "unit": "packages", "unitSymbol": "förp", "ingredientName": "strimlad rökt skinka (à 180 g)" },
    { "groupId": 4, "amount": 1.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "riven prästost" },

    { "groupId": 5, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt" },
    { "groupId": 5, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "peppar" },

    { "groupId": 6, "amount": 3, "unit": "pieces", "unitSymbol": "st", "ingredientName": "tomater (3–4 st)" },
    { "groupId": 6, "amount": 0.5, "unit": "package", "unitSymbol": "förp", "ingredientName": "färsk gräslök (à 20 g)" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Koka pastan enligt anvisningen på förpackningen." },
    { "groupId": 2, "stepNumber": 2, "instruction": "Stek löken i smöret eller oljan i en stekpanna eller kastrull." },
    { "groupId": 3, "stepNumber": 3, "instruction": "Sänk värmen och blanda i grädden och majsstärkelsen utrörd i mjölken. Smula i buljongtärningen och koka upp under omrörning." },
    { "groupId": 4, "stepNumber": 4, "instruction": "Rör i skinkan och osten och låt allt bli varmt." },
    { "groupId": 5, "stepNumber": 5, "instruction": "Smaka av med salt och peppar." },
    { "groupId": 6, "stepNumber": 6, "instruction": "Skär tomaterna och hacka gräslöken." },
    { "groupId": 1, "stepNumber": 7, "instruction": "Servera pastan med ost- och skinksås, tomater och gräslök." }
  ]
},
{
  "id": 14,
  "title": "Kyckling satay med jordnötssås",
  "serves": 4,
  "ingredients": [
    { "groupId": 1, "amount": 3, "unit": "piece", "unitSymbol": "st", "ingredientName": "kycklingfilé" },

    { "groupId": 2, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "ingefära, finhackad" },
    { "groupId": 2, "amount": 3, "unit": "cloves", "unitSymbol": "st", "ingredientName": "vitlök, pressad" },
    { "groupId": 2, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "citrongräs eller limeblad" },
    { "groupId": 2, "amount": 2, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "soja" },
    { "groupId": 2, "amount": 2, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "fisksås" },
    { "groupId": 2, "amount": 2, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "olja" },
    { "groupId": 2, "amount": 4, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "palmsocker eller ljust råsocker" },
    { "groupId": 2, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "gurkmeja" },
    { "groupId": 2, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "korianderpulver" },

    { "groupId": 3, "amount": 1, "unit": "dl", "unitSymbol": "dl", "ingredientName": "jordnötssmör, osötat med bitar" },
    { "groupId": 3, "amount": 200, "unit": "g", "unitSymbol": "g", "ingredientName": "kokosmjölk" },
    { "groupId": 3, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "lök" },
    { "groupId": 3, "amount": 1, "unit": "clove", "unitSymbol": "st", "ingredientName": "vitlök" },
    { "groupId": 3, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "ingefära, finhackad" },
    { "groupId": 3, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "röd chili" },
    { "groupId": 3, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "röd curry eller sambal oelek" },
    { "groupId": 3, "amount": 2, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "palmsocker eller ljust råsocker" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "soja" },
    { "groupId": 3, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Blanda alla ingredienser till marinaden och låt stå i 10–15 minuter." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Skär kycklingen i bitar och blanda väl med marinaden. Låt marinera minst 1 timme i rumstemperatur eller över natten i kyl." },
    { "groupId": 1, "stepNumber": 3, "instruction": "Blötlägg träspett i vatten i 30 minuter vid användning. Trä kycklingen på spett och grilla på grill eller i ugn på 225°C med grillfunktion i cirka 15 minuter tills genomstekt." },
    { "groupId": 2, "stepNumber": 4, "instruction": "Hacka lök, vitlök, ingefära och chili. Stek i olja på medelvärme tills löken mjuknar." },
    { "groupId": 2, "stepNumber": 5, "instruction": "Tillsätt röd curry eller sambal oelek och fräs kort. Sänk värmen och rör ner jordnötssmör." },
    { "groupId": 2, "stepNumber": 6, "instruction": "Mixa slätt. Tillsätt kokosmjölk, socker och soja. Smaka av med salt och låt sjuda 3–5 minuter under omrörning." },
    { "groupId": 3, "stepNumber": 7, "instruction": "Späd med mer kokosmjölk vid behov. Servera såsen varm eller kall till kycklingspetten." }
  ]
}
,
{
  "id_name": "icecream",
  "id": 15,
  "title": "Gräddglass",
  "serves": null,
  "ingredients": [
    { "groupId": 1, "amount": 1, "unit": "dl", "unitSymbol": "dl", "ingredientName": "grapejuice" },
    { "groupId": 1, "amount": 1, "unit": "can", "unitSymbol": "burk", "ingredientName": "kondenserad mjölk" },
    { "groupId": 1, "amount": 5, "unit": "dl", "unitSymbol": "dl", "ingredientName": "vispgrädde" },
    { "groupId": 1, "amount": 1, "unit": "krm", "unitSymbol": "krm", "ingredientName": "vaniljpulver" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Blanda ihop alla ingredienser i en bunke." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Häll smeten i glassmaskinen." }
  ]
}
,
{
  "id_name": "bluebarry_icecream",
  "id": 16,
  "title": "Blåbärsgräddglass",
  "serves": null,
  "ingredients": [
    { "groupId": 1, "amount": 250, "unit": "g", "unitSymbol": "g", "ingredientName": "blåbär" },
    { "groupId": 1, "amount": 1, "unit": "can", "unitSymbol": "burk", "ingredientName": "kondenserad mjölk" },
    { "groupId": 1, "amount": 4, "unit": "dl", "unitSymbol": "dl", "ingredientName": "vispgrädde" },
    { "groupId": 1, "amount": 1, "unit": "krm", "unitSymbol": "krm", "ingredientName": "vaniljpulver" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Mixa blåbären släta tillsammans med den kondenserade mjölken." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Blanda ner resterande ingredienser." },
    { "groupId": 1, "stepNumber": 3, "instruction": "Häll smeten i glassmaskinen." }
  ]
}
,
{
  "id_name": "strawberry_icecream",
  "id": 17,
  "title": "Jordgubbsgräddglass",
  "serves": null,
  "ingredients": [
    { "groupId": 1, "amount": 200, "unit": "g", "unitSymbol": "g", "ingredientName": "jordgubbar" },
    { "groupId": 1, "amount": 2.5, "unit": "dl", "unitSymbol": "dl", "ingredientName": "kondenserad mjölk" },
    { "groupId": 1, "amount": 4, "unit": "dl", "unitSymbol": "dl", "ingredientName": "vispgrädde" },
    { "groupId": 1, "amount": 1, "unit": "krm", "unitSymbol": "krm", "ingredientName": "vaniljpulver" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Mixa jordgubbarna släta tillsammans med den kondenserade mjölken." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Blanda ner resterande ingredienser." },
    { "groupId": 1, "stepNumber": 3, "instruction": "Häll smeten i glassmaskinen." }
  ]
}
,
{
  "id_name": "toffee_with_chocolate_topping_and_seasalt_flakes",
  "id": 18,
  "title": "Knäck med chokladtäcke & flingsalt",
  "serves": 45,
  "ingredients": [
    { "groupId": 1, "amount": 1, "unit": "dl", "unitSymbol": "dl", "ingredientName": "vispgrädde" },
    { "groupId": 1, "amount": 1, "unit": "dl", "unitSymbol": "dl", "ingredientName": "ljus sirap" },
    { "groupId": 1, "amount": 1, "unit": "dl", "unitSymbol": "dl", "ingredientName": "strösocker" },
    { "groupId": 1, "amount": 1, "unit": "dl", "unitSymbol": "dl", "ingredientName": "sötmandel, hackad" },
    { "groupId": 2, "amount": 150, "unit": "grams", "unitSymbol": "g", "ingredientName": "mörk choklad" },
    { "groupId": 3, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "flingsalt" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Ställ ut knäckformar på en bricka eller plåt. Koka upp grädde, sirap och socker i en kastrull. Låt sjuda på medelhög värme till 125 grader. Ta bort eventuellt socker på kastrullsidorna med en blöt pensel. Ta kastrullen från värmen och blanda ner mandeln." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Häll knäcksmeten i formarna till cirka 3/4. Låt stelna." },
    { "groupId": 2, "stepNumber": 3, "instruction": "Hacka chokladen och smält den i en skål över sjudande vattenbad. Toppa knäcken med choklad." },
    { "groupId": 3, "stepNumber": 4, "instruction": "Strö över flingsalt och låt stelna." }
  ]
}
,
{
    "id_name": "indian_stew",
    "id": 1,
    "title": "Indisk gryta",
    "serves": 4,
    "ingredients": [
        { "groupId": 1, "amount": 100, "unit": "grams", "unitSymbol": "g", "ingredientName": "smör" },
        { "groupId": 1, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "olja" },
        { "groupId": 1, "amount": 2, "unit": "cloves", "unitSymbol": "st", "ingredientName": "vitlök" },
        { "groupId": 1, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "rödlök" },
        { "groupId": 1, "amount": 2, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "ingefära" },
        { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "tomatpuré" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "koriander, pulver" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "korianderfrön" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "chili" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "socker" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "peppar" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "curry" },
        { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "kummin" },
        { "groupId": 3, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "tomat" },
        { "groupId": 3, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "paprika" },
        { "groupId": 4, "amount": 400, "unit": "g", "unitSymbol": "g", "ingredientName": "krossad tomat" },
        { "groupId": 5, "amount": 2, "unit": "dl", "unitSymbol": "dl", "ingredientName": "röda linser" },
        { "groupId": 6, "amount": 2, "unit": "piece", "unitSymbol": "st", "ingredientName": "kyckling" },
        { "groupId": 7, "amount": 2, "unit": "dl", "unitSymbol": "dl", "ingredientName": "yoghurt" }
    ],
    "instructions": [
        { "groupId": 1, "stepNumber": 1, "instruction": "Hack och fräs lök, vitlök, ingefära i smör." },
        { "groupId": 2, "stepNumber": 2, "instruction": "Tillsätt kryddor och tomatpuré." },
        { "groupId": 3, "stepNumber": 3, "instruction": "Hack och fräs snabbt till tomat och paprika." },
        { "groupId": 4, "stepNumber": 4, "instruction": "Häll i krossad tomat och vatten." },
        { "groupId": 5, "stepNumber": 5, "instruction": "Tillsätt linser." },
        { "groupId": 6, "stepNumber": 6, "instruction": "Tärna och lägg i kycklingen." },
        { "groupId": 7, "stepNumber": 7, "instruction": "Tillsätt yoghurt och låt koka in.." }
    ]
},
{
  "id_name": "curry_chicken_and_pasta",
  "id": 2,
  "title": "Curry- & kycklingsås och pasta",
  "serves": 5,
  "ingredients": [
    { "groupId": 1, "amount": 500, "unit": "grams", "unitSymbol": "g", "ingredientName": "pasta" },
    { "groupId": 2, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "smör" },
    { "groupId": 2, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "lök" },
    { "groupId": 2, "amount": 1, "unit": "clove", "unitSymbol": "st", "ingredientName": "vitlök" },
    { "groupId": 3, "amount": 500, "unit": "grams", "unitSymbol": "g", "ingredientName": "kycklingfilé" },
    { "groupId": 3, "amount": 1.5, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "kycklingfond" },
    { "groupId": 4, "amount": 4, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "crème fraiche" },
    { "groupId": 4, "amount": 1, "unit": "deciliter", "unitSymbol": "dl", "ingredientName": "grädde" },
    { "groupId": 5, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "curry" },
    { "groupId": 5, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "paprika" },
    { "groupId": 5, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt" },
    { "groupId": 5, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "peppar" },
    { "groupId": 5, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "Sriracha" },
    { "groupId": 6, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "majsmjöl" },
    { "groupId": 6, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "vatten" }
  ],
  "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Koka pastan enligt ansviningar." },
    { "groupId": 3, "stepNumber": 2, "instruction": "Grovhacka lök och vitlök, stek mjukt i smör." },
    { "groupId": 5, "stepNumber": 3, "instruction": "Tillsätt kryddor och stek i en minut." },
    { "groupId": 2, "stepNumber": 4, "instruction": "Skär kycklingen i lagom stora bitar och lägg i pannan." },
    { "groupId": 2, "stepNumber": 5, "instruction": "Stek tills kycklingen är färdig och häll på kycklingfonden." },
    { "groupId": 4, "stepNumber": 6, "instruction": "Låt koka lätt och tillsätt grädde samt crème fraiche." },
    { "groupId": 5, "stepNumber": 7, "instruction": "Smaka av med salt, peppar och Sriracha." },
    { "groupId": 6, "stepNumber": 8, "instruction": "Om såsen blir för lös, toppred av med majsmjöl utrört i lite vatten." }
  ]
},
{
    "id_name": "bbq_beans",
    "id": 3,
    "title": "BBQ Beans",
    "serves": 4,
    "ingredients": [
    { "groupId": 1, "amount": 400, "unit": "grams", "unitSymbol": "g", "ingredientName": "mix bönor" },
    { "groupId": 1, "amount": 1, "unit": "slice", "unitSymbol": "st", "ingredientName": "baccon, skivad" },
    { "groupId": 2, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "gul lök" },
    { "groupId": 2, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "grön paprika" },
    { "groupId": 2, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "jalapeño" },
    { "groupId": 2, "amount": 1, "unit": "clove", "unitSymbol": "st", "ingredientName": "vitlök" },
    { "groupId": 3, "amount": 2.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "ketchup" },
    { "groupId": 3, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "tomatpure" },
    { "groupId": 3, "amount": "1–2", "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "bruntsocker" },
    { "groupId": 3, "amount": 1.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "äppeljuice" },
    { "groupId": 3, "amount": 0.5, "unit": "deciliter", "unitSymbol": "dl", "ingredientName": "honung" },
    { "groupId": 3, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "mörksirap" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "äppel cider vinäger" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "bbq rub" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "gul senap" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "hot sauce" },
    { "groupId": 3, "amount": "1–2", "unit": "drops", "unitSymbol": "droppar", "ingredientName": "liquid smoke" },

    { "groupId": 4, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt" },
    { "groupId": 4, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "svart pepper" }
    ],
    "instructions": [
    { "groupId": 0, "stepNumber": 1, "instruction": "Förvarm ugnen till 150°C." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Hack och stek baccon tills knaprig. Lyft ur pannan men spara fetet." },
    { "groupId": 2, "stepNumber": 3, "instruction": "Lägg i finhackade löken och stek till brun runt kanterna, ca 7m." },
    { "groupId": 2, "stepNumber": 4, "instruction": "Lägg i finhackad grön paprika, jalapeño, och vitlök. Stek ca 1m, tills mjuknat." },
    { "groupId": 3, "stepNumber": 5, "instruction": "Tillsätt ketchup, brunsocker, äppeljuice, honung, sirap,vinäger, BBQ rub, senap, hot sauce, liquid smoke, och den steka baconen. Få det att börja putra." },
    { "groupId": 1, "stepNumber": 6, "instruction": "Vänd ner avrunna bönorna och blanda." },
    { "groupId": 4, "stepNumber": 7, "instruction": "Sätt in pannan i ugnen i ca 50m. Låt därefter vila ca 15m innan servering." },
    { "groupId": 3, "stepNumber": 8, "instruction": "Smaka av med salt och peppar innan servering." }
    ]
},
{
    "id_name": "christmas_meatballs",
    "id": 4,
    "title": "Julköttbullar",
    "serves": 50,
    "ingredients": [
    { "groupId": 1, "amount": 500, "unit": "grams", "unitSymbol": "g", "ingredientName": "nötfärs" },
    { "groupId": 1, "amount": 2, "unit": "pinches", "unitSymbol": "krm", "ingredientName": "kryddpeppar" },
    { "groupId": 1, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "kryddnejlika" },
    { "groupId": 1, "amount": 2, "unit": "pinches", "unitSymbol": "krm", "ingredientName": "svartpeppar" },
    { "groupId": 3, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "gul lök" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "smör" },
    { "groupId": 4, "amount": 0.5, "unit": "deciliter", "unitSymbol": "dl", "ingredientName": "ströbröd" },
    { "groupId": 4, "amount": 0.5, "unit": "deciliter", "unitSymbol": "dl", "ingredientName": "mjölk" },
    { "groupId": 4, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "ägg" },
    { "groupId": 4, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "kalvfond" },
    { "groupId": 5, "amount": 2, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "västerbottensost, riven" }
    ],
    "instructions": [
    { "groupId": 0, "stepNumber": 1, "instruction": "Förvärm ugnen till 250°C (över- och undervärme)." },
    { "groupId": 4, "stepNumber": 2, "instruction": "Blanda ägg, mjölk, ströbröd och kalvfond. Låt svälla i 5 minuter." },
    { "groupId": 3, "stepNumber": 3, "instruction": "Finhacka och fräs löken i smör tills mjuk." },
    { "groupId": 1, "stepNumber": 4, "instruction": "Blanda färs med kryddnejlika, kryddpeppar och svartpeppar." },
    { "groupId": 5, "stepNumber": 5, "instruction": "Tillsätt rivnen västerbottensosten och rör ihop allt till en smet." },
    { "groupId": 0, "stepNumber": 6, "instruction": "Rulla köttbullar med fuktiga händer och lägg på en oljad plåt." },
    { "groupId": 0, "stepNumber": 7, "instruction": "Stek i ugn 8–12 minuter vid 250°C, vänd efter cirka 7 minuter." }
    ]
},
{
    "id_name": "smoked_pastasalmond_with_horseradishsalad",
    "id": 5,
    "title": "Kallrökt laxpasta med pepparrot och fänkålssallad",
    "serves": 4,
    "ingredients": [
    { "groupId": 1, "amount": 4, "unit": "portions", "unitSymbol": "port", "ingredientName": "pasta, t.ex. tagliatelle" },
    { "groupId": 2, "amount": 125, "unit": "grams", "unitSymbol": "g", "ingredientName": "färskost med pepparrot" },
    { "groupId": 2, "amount": 2, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "mjölk" },
    { "groupId": 2, "amount": 400, "unit": "grams", "unitSymbol": "g", "ingredientName": "kallrökt lax" },
    { "groupId": 3, "amount": 1, "unit": "half", "unitSymbol": "st", "ingredientName": "apelsin (saft och skal)" },
    { "groupId": 3, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "olivolja" },
    { "groupId": 3, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt och peppar" },
    { "groupId": 4, "amount": 2, "unit": "fennel bulbs", "unitSymbol": "st", "ingredientName": "fänkål" },
    { "groupId": 4, "amount": 2, "unit": "carrots", "unitSymbol": "st", "ingredientName": "morötter" }
    ],
    "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Sätt på en kastrull med vatten till pastan." },
    { "groupId": 4, "stepNumber": 2, "instruction": "Fänkålssallad: Ansa och strimla fänkålen tunt. Skala morötterna och breda morotssnudlar med en potatisskalare." },
    { "groupId": 3, "stepNumber": 3, "instruction": "Riv apelsinskalet och pressa saften. Blanda det med olivolja i en skål där grönsakerna får plats. Smaka av med salt och peppar." },
    { "groupId": 1, "stepNumber": 4, "instruction": "Pasta: Koka pastan enligt anvisningarna på förpackningen. Låt den rinna av i ett durkslag. Värm färskosten och mjölken i pastakastrullen, krydda med salt och peppar, och vänd ner pastan." },
    { "groupId": 4, "stepNumber": 5, "instruction": "Fänkålssallad: Låt fänkål och morotssnudlar rinna av ordentligt och vänd ner dem i dressingen." },
    { "groupId": 2, "stepNumber": 6, "instruction": "Servera den varma pastan med kallrökt lax och fänkålssallad." }
    ]
},
{
    "id_name": "green_couscous_with_tomato_and_halloumi",
    "id": 6,
    "title": "Grön couscous med tomat och halloumi",
    "serves": 4,
    "ingredients": [
    { "groupId": 1, "amount": 0.5, "unit": "stalk", "unitSymbol": "st", "ingredientName": "stjälkselleri (ca 45 g)" },
    { "groupId": 1, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "röd peppar" },
    { "groupId": 1, "amount": 1, "unit": "tablespoon", "unitSymbol": "msk", "ingredientName": "olja" },
    { "groupId": 1, "amount": 1, "unit": "clove", "unitSymbol": "st", "ingredientName": "vitlök" },
    { "groupId": 1, "amount": 1, "unit": "can", "unitSymbol": "burk", "ingredientName": "körsbärstomater (400 g)" },
    { "groupId": 1, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt och peppar" },

    { "groupId": 2, "amount": 65, "unit": "grams", "unitSymbol": "g", "ingredientName": "babyspenat" },
    { "groupId": 2, "amount": 4, "unit": "portions", "unitSymbol": "port", "ingredientName": "couscous" },
    { "groupId": 2, "amount": 0.5, "unit": "bunch", "unitSymbol": "knippe", "ingredientName": "persilja" },
    { "groupId": 2, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "citron" },

    { "groupId": 3, "amount": 400, "unit": "grams", "unitSymbol": "g", "ingredientName": "halloumi" },
    { "groupId": 3, "amount": 1, "unit": "teaspoon", "unitSymbol": "tsk", "ingredientName": "olja (till stekning)" },
    { "groupId": 4, "amount": 300, "unit": "grams", "unitSymbol": "g", "ingredientName": "svarta oliver" }
    ],
    "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Tomatsås: Ansa och strimla stjälksellerin fint. Dela, kärna ur och strimla chilin." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Fräs grönsakerna mjuka i olivolja i en kastrull. Pressa i vitlöken. Häll i tomaterna och låt sjuda ca 5 minuter. Smaka av med salt och peppar." },
    { "groupId": 2, "stepNumber": 3, "instruction": "Couscous: Mixa spenat och couscous i en matberedare." },
    { "groupId": 2, "stepNumber": 4, "instruction": "Hacka persiljan och riv skalet av citronen." },
    { "groupId": 3, "stepNumber": 5, "instruction": "Halloumi: Skiva och stek halloumin i oljan i en stekpanna." },
    { "groupId": 4, "stepNumber": 6, "instruction": "Låt oliverna rinna av." },
    { "groupId": 2, "stepNumber": 7, "instruction": "Couscous: Vänd ner citronskalet och persiljan i couscousen och fluffa upp med en gaffel. Skär resten av citronen i klyftor." },
    { "groupId": 5, "stepNumber": 8, "instruction": "Servera couscousen med tomatsås, halloumi, oliver och citronklyftor." }
    ]
},
{
    "id_name": "tikki_masala_tomato",
    "id": 7,
    "title": "Indisk kyckling (Tikka masala tomat)",
    "serves": 4,
    "ingredients": [
    { "groupId": 1, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "smör" },
    { "groupId": 1, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "gul lök" },
    { "groupId": 1, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "potatis" },
    { "groupId": 1, "amount": 2, "unit": "piece", "unitSymbol": "st", "ingredientName": "morot" },
    { "groupId": 2, "amount": 2, "unit": "teaspoons", "unitSymbol": "tsk", "ingredientName": "kummin, stött" },
    { "groupId": 2, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "tomatpuré" },
    { "groupId": 3, "amount": 5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "kycklingfond" },
    { "groupId": 3, "amount": 2, "unit": "pieces", "unitSymbol": "st", "ingredientName": "kycklingbröst" },
    { "groupId": 3, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt och peppar" },
    { "groupId": 4, "amount": 2, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "crème fraîche" },
    { "groupId": 4, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "lime (saft och zest)" }
    ],
    "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Stek i smör eller olja. Fräs finhackad morot, lök, potatis och kummin." },
    { "groupId": 2, "stepNumber": 2, "instruction": "Tillsätt kummin och tomatpuré. Fräs kort för att frigöra smak." },
    { "groupId": 3, "stepNumber": 3, "instruction": "Lägg i tärnad kycklingbröst. Stek lätt tills ytan får färg." },
    { "groupId": 3, "stepNumber": 4, "instruction": "Häll på kycklingfond och låt puttra tills kycklingen är genomstekt." },
    { "groupId": 3, "stepNumber": 5, "instruction": "Häll på kycklingfond och låt puttra tills kycklingen är genomstekt." },
    { "groupId": 4, "stepNumber": 6, "instruction": "Tillsätt crème fraîche och limesaft. Smaka av med salt och peppar." },
    { "groupId": 4, "stepNumber": 7, "instruction": "Servera med ris eller naan." }
    ]
},
{
    "id_name": "halloumi_marinated_with_vegetablesalad_and_cashews",
    "id": 8,
    "title": "Marinerad halloumi med grönsakssallad och cashewnötter",
    "serves": 4,
    "ingredients": [
    { "groupId": 1, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "ingefära" },
    { "groupId": 1, "amount": 2, "unit": "cloves", "unitSymbol": "st", "ingredientName": "vitlök" },
    { "groupId": 1, "amount": 0.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "sojasås" },
    { "groupId": 1, "amount": 0.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "honung" },
    { "groupId": 1, "amount": 0.5, "unit": "deciliters", "unitSymbol": "dl", "ingredientName": "ketchup" },
    { "groupId": 1, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "vitvinsvinäger" },
    { "groupId": 1, "amount": 2, "unit": "teaspoons", "unitSymbol": "tsk", "ingredientName": "sesamfrön" },

    { "groupId": 2, "amount": 400, "unit": "grams", "unitSymbol": "g", "ingredientName": "halloumi" },

    { "groupId": 3, "amount": 200, "unit": "grams", "unitSymbol": "g", "ingredientName": "spetskål" },
    { "groupId": 3, "amount": 2, "unit": "pieces", "unitSymbol": "st", "ingredientName": "morot" },
    { "groupId": 3, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "paprika" },
    { "groupId": 3, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "salladslök" },
    { "groupId": 3, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt" },

    { "groupId": 4, "amount": 1, "unit": "bunch", "unitSymbol": "påse", "ingredientName": "koriander" },
    { "groupId": 4, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "chili" },
    { "groupId": 4, "amount": 2, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "olivolja" },
    { "groupId": 4, "amount": 1, "unit": "piece", "unitSymbol": "st", "ingredientName": "lime, juice" },
    { "groupId": 4, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "salt, nypa" },

    { "groupId": 5, "amount": 40, "unit": "grams", "unitSymbol": "g", "ingredientName": "cashewnötter" }
    ],
    "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Sätt ugnen på 200°C. Skala och finhacka ingefära och vitlök. Blanda med sojasås, honung, ketchup, vitvinsvinäger och sesamfrön till en marinad. Hetta upp en stekpanna på medelvärme och sjud marinaden tills den tjocknar något, ca 2–3 minuter. Stäng av värmen." },
    { "groupId": 2, "stepNumber": 2, "instruction": "Skär halloumin i 1 cm tjocka stavar och lägg dem på en plåt med bakplåtspapper. Ringla över marinaden så att alla bitar täcks. Tillaga i ugnen 10–12 minuter." },
    { "groupId": 3, "stepNumber": 3, "instruction": "Strimla spetskålen fint. Skala och skär morötterna i tändstickstunna stavar. Kärna ur och skär paprikan i 3 cm bitar. Grovhacka salladslöken. Blanda alla grönsaker i en stor skål och krydda med en nypa salt." },
    { "groupId": 4, "stepNumber": 4, "instruction": "Finhacka koriander. Kärna ur och hacka chilin fint. Blanda koriander och chili i en skål med olivolja och pressad limejuice. Smaka av med en nypa salt." },
    { "groupId": 5, "stepNumber": 5, "instruction": "Grovhacka cashewnötterna." },
    { "groupId": 6, "stepNumber": 6, "instruction": "Fördela salladen mellan tallrikar och toppa med de marinerade halloumibitarna. Strö över cashewnötterna." }
    ]
},
{
    "id_name": "aw_grandmas_bread",
    "id": 9,
    "title": "Farmors bröd",
    "serves": 9,
    "ingredients": [
    { "groupId": 1, "amount": 1.5, "unit": "packages", "unitSymbol": "pkt", "ingredientName": "packet gramhams mjöl" },
    { "groupId": 1, "amount": null, "unit": null, "unitSymbol": null, "ingredientName": "siktat grahamsmjöl (efter konsistens på degen)" },
    { "groupId": 1, "amount": 1.5, "unit": "tablespoons", "unitSymbol": "msk", "ingredientName": "salt" },
    { "groupId": 1, "amount": "1½–2", "unit": "packages", "unitSymbol": "pkt", "ingredientName": "jäst" },
    { "groupId": 1, "amount": 1.5, "unit": "liters", "unitSymbol": "l", "ingredientName": "vätska (1,1 l standardmjölk, 4 dl vatten eller 1,5 l mellanmjölk)" }
    ],
    "instructions": [
    { "groupId": 1, "stepNumber": 1, "instruction": "Smula eller finfördela jästen i en stor bunke." },
    { "groupId": 1, "stepNumber": 2, "instruction": "Blanda ut jästen med den ljumma vätskan." },
    { "groupId": 1, "stepNumber": 3, "instruction": "Tillsätt mjölet i bunken lite åt gången tills degen inte är för hård men något klibbig i konsistensen. Degen ska vara lite klibbig men inte för hård." },
    { "groupId": 1, "stepNumber": 4, "instruction": "Lägg lite mjöl på toppen och låt jäsa ca 30 minuter under bakduk." },
    { "groupId": 2, "stepNumber": 5, "instruction": "Baka ut degen, knåda ej utan forma till en rulle. Skär sedan av en bit och klappa den med båda händerna. Upprepa tills du fått ca 9 bitar." },
    { "groupId": 2, "stepNumber": 6, "instruction": "Ta en bit deg i taget och baka ut först och forma till en rund tunn kaka. Lägg kakan på mjölat bord och låt jäsa under tiden som du bakar ut de andra kakorna." },
    { "groupId": 3, "stepNumber": 7, "instruction": "Nagga med en gaffel och grädda i 230–250°C i ca 7–10 minuter tills kakorna fått färg." },
    { "groupId": 3, "stepNumber": 8, "instruction": "Borsta av kakorna med en visp eller ren diskborste när de är färdiga." }
    ]
}];
    // ─────────────────────────────────────────────────────────────
// Module: filterRecipes.js
// ─────────────────────────────────────────────────────────────
/**
 * recipeFilter.js - Filter recipes by search query
 */

/**
 * Filter recipes by title
 * @param {Array<{object: recipe}>} recipes - Array of recipe objects
 * @param {object<{id: number}, {object: recipe}>} recipeDict - Dictionary of recipe objects
 * @param {string} query - Search query
 * @param {func} loadRecipes - Load recipes function
 * @returns {Array} Filtered recipes
 */
function filterRecipes(recipes, recipeDict, query, loadRecipes) {
  if(query === '') return recipes;

  if(miniSearch !== 'undefined'){
    var hits= miniSearch.search(query, { prefix: true });
    const loaded = loadRecipes(recipeDict, hits)
    return loaded;
  }

  console.error("MiniSearch is not defined, falling back to basic filter");
  const lowerQuery = query.toLowerCase();
  return recipes.filter(recipe =>
    recipe.title.toLowerCase().includes(lowerQuery)
  );
}

// Export for use in modules
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { filterRecipes };
}


// ─────────────────────────────────────────────────────────────
// Module: hashRouter.js
// ─────────────────────────────────────────────────────────────
/**
 * hashRouter.js - Minimal hash-based router with simple param matching
 *
 * Usage:
 * const router = createRouter([
 *   { pattern: '/', handler: () => {} },
 *   { pattern: '/recipe/:id', handler: ({id}) => {} }
 * ]);
 * router.start();
 */

function createRouter(routes) {
  function normalize(hash) {
    if (!hash) return '/';
    let h = hash.replace(/^#/, '');
    if (!h) return '/';
    if (!h.startsWith('/')) h = '/' + h;
    return h;
  }

  function matchRoute(path, pattern) {
    const pSeg = pattern.split('/').filter(Boolean);
    const pathSeg = path.split('/').filter(Boolean);
    if (pSeg.length !== pathSeg.length) return null;
    const params = {};
    for (let i = 0; i < pSeg.length; i++) {
      const ps = pSeg[i];
      const xs = pathSeg[i];
      if (ps.startsWith(':')) {
        params[ps.slice(1)] = decodeURIComponent(xs);
      } else if (ps !== xs) {
        return null;
      }
    }
    return params;
  }

  function handleHashChange() {
    const raw = normalize(location.hash);
    for (const r of routes) {
      const params = matchRoute(raw, r.pattern === '/' ? '/' : r.pattern);
      if (params !== null) {
        try {
          r.handler(params || {});
        } catch (err) {
          console.error('Route handler error', err);
        }
        return;
      }
    }

    // If no route matched, try root
    const root = routes.find(rr => rr.pattern === '/' || rr.pattern === '');
    if (root) root.handler({});
  }

  return {
    start() {
      // handle initial
      handleHashChange();
      window.addEventListener('hashchange', handleHashChange, false);
    },
    navigate(path) {
      if (!path.startsWith('#')) path = '#' + (path.startsWith('/') ? path.slice(1) : path);
      location.hash = path;
    }
  };
}

// Export for Node tests
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { createRouter };
}


// ─────────────────────────────────────────────────────────────
// Module: highlightManager.js
// ─────────────────────────────────────────────────────────────
/**
 * highlightManager.js - Manage cross-highlighting between ingredients and instructions
 */

/**
 * Setup cross-highlighting between ingredient groups and instruction steps
 * @param {HTMLElement} container - Container with rendered recipe detail
 */
function setupHighlighting(container) {
  let highlightedGroupId = null;
  
  const ingredientGroupEls = Array.from(container.querySelectorAll('.ingredient-group'));
  const instructionEls = Array.from(container.querySelectorAll('.instruction'));
  
  const ingredientGroupElsById = new Map(
    ingredientGroupEls.map(el => [el.getAttribute('data-group-id'), el])
  );
  
  const instructionElsByGroupId = new Map();
  instructionEls.forEach(el => {
    const gid = el.getAttribute('data-group-id');
    if (!instructionElsByGroupId.has(gid)) {
      instructionElsByGroupId.set(gid, []);
    }
    instructionElsByGroupId.get(gid).push(el);
  });
  
  /**
   * Set or toggle highlight for a group
   * @param {string|null} groupId - Group ID to highlight, or null to clear
   */
  function setHighlightedGroup(groupId) {
    ingredientGroupElsById.forEach(el => el.classList.remove('highlighted'));
    instructionEls.forEach(el => el.classList.remove('highlighted'));
    
    highlightedGroupId = groupId;
    if (!groupId) return;
    
    const groupEl = ingredientGroupElsById.get(String(groupId));
    if (groupEl) groupEl.classList.add('highlighted');
    
    const steps = instructionElsByGroupId.get(String(groupId)) || [];
    steps.forEach(el => el.classList.add('highlighted'));
  }
  
  // Add click listeners to ingredients
  ingredientGroupElsById.forEach((el, gid) => {
    el.addEventListener('click', () => {
      setHighlightedGroup(highlightedGroupId === gid ? null : gid);
    });
  });
  
  // Add click listeners to instructions
  instructionEls.forEach(el => {
    el.addEventListener('click', () => {
      const gid = el.getAttribute('data-group-id');
      setHighlightedGroup(highlightedGroupId === gid ? null : gid);
    });
  });
  
  return {
    setHighlightedGroup,
    clear: () => setHighlightedGroup(null)
  };
}

// Export for use in modules
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { setupHighlighting };
}


// ─────────────────────────────────────────────────────────────
// Module: loadRecipes.js
// ─────────────────────────────────────────────────────────────
/**
 * loadRecipes.js - Load recipes by from search hits
 */

/**
 * Filter recipes by title
 * @param {object<{id: number}, {object: recipe}>} recipeDict - Dictionary of recipe objects
 * @param {Array<{object: hits}>} recipes - Array of hit objects
 * @returns {Array} Loaded recipes
 */
function loadRecipes(recipeDict, searchHits) {
  return searchHits.map(s=> recipeDict[s.id]);
}

// Export for use in modules
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { loadRecipes };
}


// ─────────────────────────────────────────────────────────────
// Module: recipeRenderer.js
// ─────────────────────────────────────────────────────────────
/**
 * recipeRenderer.js - Render recipe list and detail views
 */

/**
 * Render recipe list cards
 * @param {HTMLElement} container - Container to render into
 * @param {Array} recipes - Array of recipe objects
 * @param {Function} onRecipeClick - Callback when recipe is clicked
 * @param {HTMLElement} noResultsEl - Element to show when no results
 */
function renderRecipeList(container, recipes, onRecipeClick, noResultsEl) {
  container.innerHTML = '';
  
  if (recipes.length === 0) {
    if (noResultsEl) noResultsEl.style.display = 'block';
    return;
  }
  
  if (noResultsEl) noResultsEl.style.display = 'none';
  
  recipes.forEach(recipe => {
    const card = document.createElement('div');
    card.className = 'recipe-card';
    card.innerHTML = `
      <h2>${recipe.title}</h2>
      <p class="recipe-meta">${recipe.ingredients.length} ingredients · ${recipe.instructions.length} steps</p>
    `;
    card.addEventListener('click', () => onRecipeClick(recipe));
    container.appendChild(card);
  });
}

/**
 * Group ingredients by groupId
 * @param {Array} ingredients - Array of ingredient objects
 * @returns {Array} Grouped ingredients
 */
function groupIngredients(ingredients) {
  const groups = [];
  const groupIndexById = new Map();
  
  ingredients.forEach((ing) => {
    const id = ing.groupId ?? '__ungrouped__';
    if (!groupIndexById.has(id)) {
      groupIndexById.set(id, groups.length);
      groups.push({ id, items: [] });
    }
    groups[groupIndexById.get(id)].items.push(ing);
  });
  
  return groups;
}

/**
 * Generate HTML for ingredients grouped section
 * @param {Array} groups - Grouped ingredients
 * @returns {string} HTML string
 */
function renderIngredientsHTML(groups) {
  return groups.map(g => `
    <div class="ingredient-group" data-group-id="${g.id}">
      ${g.items.map(ing => `
        <div class="ingredient">
          <span class="ingredient-amount">${ing.amount ?? ''} ${ing.unitSymbol ?? ''}</span>
          <span>${ing.ingredientName}</span>
        </div>
      `).join('')}
    </div>
  `).join('');
}

/**
 * Generate HTML for instructions
 * @param {Array} instructions - Array of instruction objects
 * @returns {string} HTML string
 */
function renderInstructionsHTML(instructions) {
  return instructions.map(inst => `
    <li class="instruction" data-group-id="${inst.groupId ?? ''}">
      <span class="step-number"></span>
      <span class="instruction-text">${inst.instruction}</span>
    </li>
  `).join('');
}

/**
 * Render recipe detail view
 * @param {HTMLElement} container - Container to render into
 * @param {Object} recipe - Recipe object with title, ingredients, instructions
 */
function renderRecipeDetail(container, recipe) {
  const groups = groupIngredients(recipe.ingredients);
  const ingredientsHtml = renderIngredientsHTML(groups);
  const instructionsHtml = renderInstructionsHTML(recipe.instructions);
  
  container.innerHTML = `
    <h1>${recipe.title}</h1>
    <div class="ingredients-section">
      <h2 class="section-title">Ingredients</h2>
      ${ingredientsHtml}
    </div>
    <div class="instructions-section">
      <h2 class="section-title">Instructions</h2>
      <ol>${instructionsHtml}</ol>
    </div>
  `;
}

// Export for use in modules
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    renderRecipeList,
    renderRecipeDetail,
    groupIngredients,
    renderIngredientsHTML,
    renderInstructionsHTML
  };
}


// ─────────────────────────────────────────────────────────────
// Module: viewManager.js
// ─────────────────────────────────────────────────────────────
/**
 * viewManager.js - Manage view switching between list and detail
 */

/**
 * Show recipe list view and hide detail view
 * @param {HTMLElement} listViewEl - List view container
 * @param {HTMLElement} detailViewEl - Detail view container
 */
function showListView(listViewEl, detailViewEl) {
  listViewEl.classList.remove('hidden');
  detailViewEl.classList.remove('active');
}

/**
 * Show recipe detail view and hide list view
 * @param {HTMLElement} listViewEl - List view container
 * @param {HTMLElement} detailViewEl - Detail view container
 */
function showDetailView(listViewEl, detailViewEl) {
  listViewEl.classList.add('hidden');
  detailViewEl.classList.add('active');
}

// Export for use in modules
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { showListView, showDetailView };
}


// ============================================================================
// Transform recipes to dict
// ============================================================================
const recipeDict = {};
recipes.forEach(r => {
  recipeDict[r.id] = r;
});

// ============================================================================
// Recipe App - Main Entry Point
// Orchestrates modules: recipeFilter, recipeRenderer, highlightManager, viewManager
// ============================================================================

// State
let currentRecipe = null;
let highlighter = null;

// DOM elements
const listView = document.getElementById('list-view');
const detailView = document.getElementById('detail-view');
const recipeList = document.getElementById('recipe-list');
const recipeDetail = document.getElementById('recipe-detail');
const searchInput = document.getElementById('search');
const backButton = document.getElementById('back-button');
const noResults = document.getElementById('no-results');

// Router (created below once createRouter is available)
let router = null;

/**
 * Handle recipe selection and show detail view
 * @param {Object} recipe - Recipe object to display
 */
function showRecipeDetail(recipe) {
  currentRecipe = recipe;
  
  // Render the recipe detail
  renderRecipeDetail(recipeDetail, recipe);
  
  // Setup cross-highlighting
  highlighter = setupHighlighting(recipeDetail);
  
  // Switch to detail view
  showDetailView(listView, detailView);
}

/**
 * Handle back button and show list view
 */
function showRecipeList() {
  currentRecipe = null;
  if (highlighter) {
    highlighter.clear();
    highlighter = null;
  }
  showListView(listView, detailView);
}

/**
 * Handle search input and filter recipes
 * @param {string} query - Search query
 */
function handleSearch(query) {
  const filtered = filterRecipes(recipes, recipeDict, query, loadRecipes);
  renderRecipeList(recipeList, filtered, (r) => router.navigate('/recipe/' + r.id_name), noResults);
}

// ============================================================================
// Event Listeners
// ============================================================================

searchInput.addEventListener('input', (e) => {
  handleSearch(e.target.value);
});

backButton.addEventListener('click', () => router.navigate('/'));

// ============================================================================
// Initial Setup
// ============================================================================

// Setup router and routes
if (typeof createRouter === 'function') {
  router = createRouter([
    { pattern: '/', handler: () => { showRecipeList(); } },
    { pattern: '/recipe/:id', handler: ({ id }) => {
      // find recipe by id (number or string)
      const found = recipes.find(r => String(r.id_name) === String(id));
      if (found) {
        // render via router-driven flow
        showRecipeDetail(found);
      } else {
        showRecipeList();
      }
    } }
  ]);
  // initial render of list with router-aware navigation
  renderRecipeList(recipeList, recipes, (r) => router.navigate('/recipe/' + r.id_name), noResults);
  router.start();
} else {
  // fallback if router isn't present: render and use direct handlers
  renderRecipeList(recipeList, recipes, showRecipeDetail, noResults);
}

// ============================================================================
// Search setup
// ============================================================================

let miniSearch = new MiniSearch({
  fields: ['id_name', 'title', 'ingredients', 'instructions'],
  tokenize: (string, _fieldName) => {
  const words = string
    .replace(/[^\p{L}]/gu, " ")
    .replace(/\s+/g, " ")
    .toLowerCase()
    .split(" ")

  const tokens = []

  for (const w of words) {
    for (let i = 1; i <= w.length; i++) {
      tokens.push(w.slice(0, i))  // prefix n-grams
    }
  }

  return tokens
},
  searchOptions: {
    processTerm: (term) => term.toLowerCase(),
    boost: { title: 2, id_name: 1.5, ingredients: 0.5, instructions: 0.5 },
    fuzzy: 0.2
  },
  extractField: (doc, fieldName) => {
    if (fieldName === 'ingredients') {
      return (doc.ingredients || [])
        .map(a => a.ingredientName || '')
        .join(' ')
    }
    if (fieldName === 'instructions') {
      return (doc.instructions || [])
        .map(a => a.instruction || '')
        .join(' ')
    }
    
    return doc[fieldName]
  }
})

miniSearch.addAll(recipes);
  </script>
</body>
</html>